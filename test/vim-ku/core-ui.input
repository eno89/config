" Test: vim-ku core-ui
runtime! plugin/ku.vim plugin/ku/**/*.vim
call vspec#hint({'scope': 'ku#_local_variables()', 'sid': 'ku#_sid_prefix()'})
function s:describe__ui_named_key_mappings()  "{{{1
  It requires the following initialization to test its effect

  let original_bufnr = bufnr('')
  let original_window_layout = winrestcmd()

  Should ku#start() == 1
  Should nr2char(getchar(0)) ==# 'A'
  Should nr2char(getchar(0)) ==# ''

  let ku_bufnr = bufnr('')
  let ku_window_layout = winrestcmd()

  close

  It should define <Plug>(ku-quit-session) and it works

  Should ku#start() == 1
  Should nr2char(getchar(0)) ==# 'A'
  Should nr2char(getchar(0)) ==# ''

  execute 'normal' "\<Plug>(ku-quit-session)"
  Should bufnr('') != ku_bufnr
  Should bufnr('') == original_bufnr
  Should winrestcmd() !=# ku_window_layout
  Should winrestcmd() ==# original_window_layout

  silent! close

  " FIXME: NIY: <Plug>(ku-choose-and-do-an-action)
  " FIXME: NIY: <Plug>(ku-do-the-default-action)

  " Reset side effect
  Should ku#start() == 1
  Should nr2char(getchar(0)) ==# 'A'
  Should nr2char(getchar(0)) ==# ''

  bwipeout!
endfunction




" __END__  "{{{1
" vim: filetype=vim foldmethod=marker
